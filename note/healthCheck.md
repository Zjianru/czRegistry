# 注册中心的探活机制

## 注册中心客户端的探活
关于探活机制,当前 czRegistry 默认使用的是主动上报的方式,即服务端主动向注册中心发送心跳包,注册中心收到心跳包后,更新服务实例的存活时间,如果服务实例存活时间超过一定时间,则认为服务实例已经死亡,从注册中心中删除该服务实例。

另外还有一种实践,服务端与注册中心约定一个能够代表服务端存活,能够提供功能的 api 接口,注册中心轮询该接口,如果该接口返回成功,则认为服务实例存活,如果该接口返回失败,则认为服务实例已经死亡,从注册中心中删除该服务实例。

## 注册中心集群节点的探活与选举

注册中心为了维持自身的高可用,通过集群方式进行部署,多节点之间仍然需要探活与选举机制来保证不会出现无主或脑裂现象出现。
集群节点的探活,是节点中开辟 REST 接口, 通过后台线程池调度线程,当发现无主或多主的情况后,通过选举机制,选举一个节点成为主节点,其他节点成为从节点,主节点负责注册中心集群的维护,从节点负责注册中心集群的维护。